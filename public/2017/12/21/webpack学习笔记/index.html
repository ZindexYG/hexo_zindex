<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-z-16x16.ico " />
  
  
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-z-16x16.ico " />
  
  
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-z-32x32.ico">
  
  
  <title>webpack学习笔记 - 时之物语</title>
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-coy.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><script src="/js/prism.js"></script>
<script src="/js/prism-line-numbers.min.js"></script></head>


  <body class="">
    <div class="container">
      <header class="header">
  <div class="blog-title">
    <a href="/" class="logo">时之物语</a>
  </div>
  <nav class="navbar">
    <ul class="menu">
      
      <li class="menu-item">
        <a href="/" class="menu-item-link menu-item-home">Home</a>
      </li>
      
      <li class="menu-item">
        <a href="/about" class="menu-item-link menu-item-about">About</a>
      </li>
      
      <li class="menu-item">
        <a href="/links" class="menu-item-link menu-item-friends">Friends</a>
      </li>
      
    </ul>
  </nav>
</header>

        <main class="main">
          
  <input type="checkbox" id="toggle-toc" class="toggle-toc-right" />
  <div class="toc-toggle toc-toggle-right">
    <label for="toggle-toc">
      <i class="fa fa-list-ol"></i>
    </label>
    <div class="toc-wrap toc-wrap-right">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#理解-WebPack"><span class="toc-number">1.</span> <span class="toc-text">理解 WebPack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#package-json-文件"><span class="toc-number">2.</span> <span class="toc-text">package.json 文件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#常见字段解析"><span class="toc-number">2.1.</span> <span class="toc-text">常见字段解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#主要配置"><span class="toc-number">3.</span> <span class="toc-text">主要配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#plugins-常用插件"><span class="toc-number">4.</span> <span class="toc-text">plugins 常用插件</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#对代码处理的插件"><span class="toc-number">4.1.</span> <span class="toc-text">对代码处理的插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#辅助打包后的代码"><span class="toc-number">4.2.</span> <span class="toc-text">辅助打包后的代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#辅助开发的相关属性"><span class="toc-number">5.</span> <span class="toc-text">辅助开发的相关属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#精细的相关属性配置"><span class="toc-number">6.</span> <span class="toc-text">精细的相关属性配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#结语"><span class="toc-number">7.</span> <span class="toc-text">结语</span></a></li></ol>
    </div>
  </div>
  <label class="mask" for="toggle-toc"></label>

<div id="post-content">
  <h1>webpack学习笔记</h1>
  <p><img src="/images/webpack-banner.jpg" alt=""></p>
<blockquote>
<p>这是一份学习笔记，仅此记录一个学习过程</p>
</blockquote>
<a id="more"></a>

<h2 id="理解-WebPack"><a href="#理解-WebPack" class="headerlink" title="理解 WebPack"></a>理解 WebPack</h2><p>学习 WebPack 最好是从服务端的角度出发，或者说从 node 角度出发，到程序的角度，再到用户的角度；</p>
<p>反过来，一部分用户是不需要一些渲染的页面的，那么从服务端开始，编写用户需要的页面；</p>
<h2 id="package-json-文件"><a href="#package-json-文件" class="headerlink" title="package.json 文件"></a>package.json 文件</h2><p>package.json 是一个 node 生成的目录文件，下面 vue-cli 生成的一个 package.json；</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token string">"name"</span><span class="token punctuation">:</span> <span class="token string">"vue-test"</span><span class="token punctuation">,</span>
  <span class="token string">"version"</span><span class="token punctuation">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>
  <span class="token string">"description"</span><span class="token punctuation">:</span> <span class="token string">"A Vue.js project"</span><span class="token punctuation">,</span>
  <span class="token string">"author"</span><span class="token punctuation">:</span> <span class="token string">"yg_zinger"</span><span class="token punctuation">,</span>
  <span class="token string">"private"</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string">"scripts"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//more</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"dependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"vue"</span><span class="token punctuation">:</span> <span class="token string">"^2.5.2"</span><span class="token punctuation">,</span>
    <span class="token string">"vue-router"</span><span class="token punctuation">:</span> <span class="token string">"^3.0.1"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"devDependencies"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// more ...</span>
    <span class="token string">"url-loader"</span><span class="token punctuation">:</span> <span class="token string">"^0.5.8"</span><span class="token punctuation">,</span>
    <span class="token string">"vue-jest"</span><span class="token punctuation">:</span> <span class="token string">"^1.0.2"</span><span class="token punctuation">,</span>
    <span class="token string">"vue-loader"</span><span class="token punctuation">:</span> <span class="token string">"^13.3.0"</span><span class="token punctuation">,</span>
    <span class="token string">"vue-style-loader"</span><span class="token punctuation">:</span> <span class="token string">"^3.0.1"</span><span class="token punctuation">,</span>
    <span class="token string">"vue-template-compiler"</span><span class="token punctuation">:</span> <span class="token string">"^2.5.2"</span><span class="token punctuation">,</span>
    <span class="token string">"webpack"</span><span class="token punctuation">:</span> <span class="token string">"^3.6.0"</span><span class="token punctuation">,</span>
    <span class="token string">"webpack-bundle-analyzer"</span><span class="token punctuation">:</span> <span class="token string">"^2.9.0"</span><span class="token punctuation">,</span>
    <span class="token string">"webpack-dev-server"</span><span class="token punctuation">:</span> <span class="token string">"^2.9.1"</span><span class="token punctuation">,</span>
    <span class="token string">"webpack-merge"</span><span class="token punctuation">:</span> <span class="token string">"^4.1.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"engines"</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token string">"node"</span><span class="token punctuation">:</span> <span class="token string">">= 4.0.0"</span><span class="token punctuation">,</span>
    <span class="token string">"npm"</span><span class="token punctuation">:</span> <span class="token string">">= 3.0.0"</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">"browserslist"</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token string">"> 1%"</span><span class="token punctuation">,</span>
    <span class="token string">"last 2 versions"</span><span class="token punctuation">,</span>
    <span class="token string">"not ie &lt;= 8"</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="常见字段解析"><a href="#常见字段解析" class="headerlink" title="常见字段解析"></a>常见字段解析</h3><table>
<thead>
<tr>
<th>字段</th>
<th>解析</th>
</tr>
</thead>
<tbody><tr>
<td>name</td>
<td>项目名</td>
</tr>
<tr>
<td>version</td>
<td>项目版本号，（大改，次改，小改）</td>
</tr>
<tr>
<td>author</td>
<td>作者名字</td>
</tr>
<tr>
<td>script</td>
<td>调用命令脚本，封装功能用</td>
</tr>
<tr>
<td>dependencies</td>
<td>项目运行所需的依赖包</td>
</tr>
<tr>
<td>devDependencies</td>
<td>项目开发所需的依赖包</td>
</tr>
<tr>
<td>engines</td>
<td>制定包的运行环境</td>
</tr>
<tr>
<td>browserlist</td>
<td>浏览器兼容性问题</td>
</tr>
<tr>
<td>config</td>
<td>用于添加命令行的环境变量</td>
</tr>
<tr>
<td>private</td>
<td>设置为ture 表示不发布到 npm 平台下</td>
</tr>
</tbody></table>
<h2 id="主要配置"><a href="#主要配置" class="headerlink" title="主要配置"></a>主要配置</h2><p>如果是个人配置，大可不必使用脚手架，以及前端框架，把 webpack 当作一个打包工具即可；</p>
<p>个人配置上面不需要太复杂，就拿一个 webpack.config.js 来看即可</p>
<pre class="line-numbers language-javascript"><code class="language-javascript"><span class="token comment" spellcheck="true">//导入所需的依赖</span>
<span class="token keyword">var</span> FriendlyErrorsWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'friendly-errors-webpack-plugin'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> ExtractTextPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'extract-text-webpack-plugin'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'webpack'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"path"</span><span class="token punctuation">)</span>

<span class="token comment" spellcheck="true">//模块输出</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment" spellcheck="true">// 入口， 可以是字符串，数组，对象</span>
  entry<span class="token punctuation">:</span> <span class="token string">'./src/mian.js'</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// 输出配置， 一般有 filenema=输出名字, path=输出地址, publicPath=输出公共资源的路径 字段</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">'/dist'</span><span class="token punctuation">,</span>
    publicPath<span class="token punctuation">:</span> <span class="token string">'/static/'</span><span class="token punctuation">,</span>
    filename<span class="token punctuation">:</span> <span class="token string">'build.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// 插件</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>ProgressPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span> <span class="token class-name">FriendlyErrorsWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment" spellcheck="true">// 模块处理</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// 字段配置</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">//test = 正则匹配规则， use = 匹配对应 loader or 对象 options</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.vue$/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span> <span class="token string">"vue-loader"</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          loaders<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            css<span class="token punctuation">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              use<span class="token punctuation">:</span> <span class="token string">'css-loader'</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            stylus<span class="token punctuation">:</span> ExtractTextPlugin<span class="token punctuation">.</span><span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">"css-loader"</span><span class="token punctuation">,</span> <span class="token string">"scss-loader"</span><span class="token punctuation">]</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.css$/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'vue-style-loader'</span><span class="token punctuation">,</span> <span class="token string">'css-loader'</span><span class="token punctuation">,</span> <span class="token string">'scss-loader'</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.(png|jpe?g|gif|svg)(\?.*)?$/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span> <span class="token string">"url-loader"</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          limit<span class="token punctuation">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
          name<span class="token punctuation">:</span> <span class="token string">'images/[name].[hash:7].[ext]'</span> <span class="token comment" spellcheck="true">// 将图片都放入images文件夹下，[hash:7]防缓存</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.(woff2?|eot|ttf|otf)(\?.*)?$/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
        loader<span class="token punctuation">:</span> <span class="token string">"url-loader"</span><span class="token punctuation">,</span>
        options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          limit<span class="token punctuation">:</span> <span class="token number">10000</span><span class="token punctuation">,</span>
          name<span class="token punctuation">:</span> <span class="token string">'fonts/[name].[hash:7].[ext]'</span> <span class="token comment" spellcheck="true">// 将字体放入fonts文件夹下</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      test<span class="token punctuation">:</span> <span class="token regex">/\.js$/</span><span class="token punctuation">,</span>
      use<span class="token punctuation">:</span> <span class="token string">"babel-loader"</span><span class="token punctuation">,</span>
      include<span class="token punctuation">:</span> <span class="token punctuation">[</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">// 压缩 javascript 的插件</span>
<span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>optimize<span class="token punctuation">.</span>UglifyJsPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">// 抽离 css 到css 文件</span>
<span class="token keyword">new</span> <span class="token class-name">ExtractTextPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  filename<span class="token punctuation">:</span> <span class="token string">"css/style.css"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="plugins-常用插件"><a href="#plugins-常用插件" class="headerlink" title="plugins 常用插件"></a>plugins 常用插件</h2><p>现在大部分插件都会在 webpack 上面集成好，所以 <a href="https://doc.webpack-china.org/plugins/" target="_blank" rel="noopener">webpack文档</a> 就很关键了，多看文档多成长;</p>
<p>下面介绍部分常用的，也是使用一些脚手架常见的插件，与个人理解；</p>
<h3 id="对代码处理的插件"><a href="#对代码处理的插件" class="headerlink" title="对代码处理的插件"></a>对代码处理的插件</h3><table>
<thead>
<tr>
<th>插件</th>
<th>用处</th>
</tr>
</thead>
<tbody><tr>
<td>BannerPlugin</td>
<td>给代码添加版权信息</td>
</tr>
<tr>
<td>CommonsChunkPlugin</td>
<td>用于共享抽离代码，整个项目的第三方；多个子 chunk 共用打包进入 父 chunk；Mainfest 每次打包都有变化</td>
</tr>
<tr>
<td>CompressionWebpackPlugin</td>
<td>使用配置算法</td>
</tr>
<tr>
<td>DefinePlugin</td>
<td>允许在编译时(compile time)配置的全局常量</td>
</tr>
<tr>
<td>EnvionmetPlugin</td>
<td>通过 DefinePlugin 来设置 process.env 环境变量的快捷方式</td>
</tr>
<tr>
<td>ProvidePlugin</td>
<td>自动加载模块，不需要 import 或者 require</td>
</tr>
<tr>
<td>UglifyJsPlugin</td>
<td>自动压缩 JS 代码(需要安装，不自带)</td>
</tr>
</tbody></table>
<h3 id="辅助打包后的代码"><a href="#辅助打包后的代码" class="headerlink" title="辅助打包后的代码"></a>辅助打包后的代码</h3><table>
<thead>
<tr>
<th>插件</th>
<th>用处</th>
</tr>
</thead>
<tbody><tr>
<td>HtmlWebpackPlugin</td>
<td>自动依据 entry 的配置引入依赖（需要安装，不自带）</td>
</tr>
<tr>
<td>cleanWebpackPlugin</td>
<td>每次打包，清空配置的文件夹，包名保持不一致 （需要安装，不自带）</td>
</tr>
</tbody></table>
<h2 id="辅助开发的相关属性"><a href="#辅助开发的相关属性" class="headerlink" title="辅助开发的相关属性"></a>辅助开发的相关属性</h2><table>
<thead>
<tr>
<th>属性</th>
<th>用处</th>
</tr>
</thead>
<tbody><tr>
<td>devtool</td>
<td>打包后的代码与原始代码不同，控制是否生成 &amp; 如何生成</td>
</tr>
<tr>
<td>devServer</td>
<td>打开本地服务器，需要配置</td>
</tr>
<tr>
<td>watch</td>
<td>持续监听文件的更改，重新构建文件，开发时期使用</td>
</tr>
<tr>
<td>watchOptions</td>
<td>定制 watch 模式</td>
</tr>
<tr>
<td>performance</td>
<td>展示性能提示</td>
</tr>
<tr>
<td>stats</td>
<td>配置打包过程输出的内容，值：none，norml，rerbese，errors-only</td>
</tr>
</tbody></table>
<h2 id="精细的相关属性配置"><a href="#精细的相关属性配置" class="headerlink" title="精细的相关属性配置"></a>精细的相关属性配置</h2><table>
<thead>
<tr>
<th>属性</th>
<th>用处</th>
</tr>
</thead>
<tbody><tr>
<td>content</td>
<td>设置基础路径，默认当前</td>
</tr>
<tr>
<td>resolve</td>
<td>确定某块如何被解析，有默认值，可自定义</td>
</tr>
<tr>
<td>target</td>
<td>打包之后代码所执行的环境</td>
</tr>
<tr>
<td>extemals</td>
<td>控制某个依赖，不打包，直接从用户环境获取</td>
</tr>
</tbody></table>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>基本上到这里了，这里大部分东西都在 <a href="https://doc.webpack-china.org/" target="_blank" rel="noopener">Webpack社区</a> 里可以查得到，习惯用了脚手架，会让突然出现的错误，措手不及，所以我们需要学习，和记录；</p>
<p>当然，最近出了个 <a href="https://parceljs.org/" target="_blank" rel="noopener">Parcel </a>，貌似更好用…有机会试一下</p>

</div>

<script>
  // I'm not sure your browser supports `es6`
  window.addEventListener('load', function () {
    [].concat(Array.from(document.querySelectorAll('code')), Array.from(document.querySelectorAll('pre'))).filter(function (item) {return item.className.indexOf('language') >= 0}).forEach(function (tag) { tag.classList.add('line-numbers') })
    Prism.highlightAll()

    let scrollY = window.scrollY
    let headersList = Array.from(document.querySelector('#post-content').querySelectorAll('h1,h2,h3,h4,h5,h6')).map(function (item) {
      let rect = item.getBoundingClientRect()
      let anchorTag = document.querySelector(`a.toc-link[href="#${item.id}"]`)

      if (!anchorTag) return
      return {
        top: scrollY + rect.top - rect.height,
        tag: item,
        anchorTag: anchorTag
      }
    }).filter(function (item) { return item })

    window.addEventListener('scroll', debounce(scrollHandler, 200))
    scrollHandler()

    function scrollHandler () {
      let scrollY = window.scrollY
      let minInfo = null

      for (let item of headersList) {
        if (!minInfo) {
          minInfo = item
          continue
        }

        if ((scrollY - item.top) >= 0 && (scrollY - minInfo.top) > (scrollY - item.top)) {
          minInfo = item
        }
      }

      if (minInfo) {
        headersList.forEach(function (item) {
          item.anchorTag && item.anchorTag.classList.remove('selected')
        })
        minInfo.anchorTag.classList.add('selected')
      }
    }

    function debounce (func, delay) {
      let debounceIdentify = 0
      return function () {
        debounceIdentify && clearTimeout(debounceIdentify)
        debounceIdentify = setTimeout(function () {
          debounceIdentify = 0
          func.apply(this, arguments)
        }, delay)
      }
    }
  })
</script>

        </main>
        <a href="#" class="goto-top">
          <i class="fa fa-chevron-up"></i>
        </a>
    </div>
    <footer class="footer">
  <div class="footer-content">
    <div class="footer-info" class="inner">
      <p class="copyright">&copy; 2020 时之物语 ZYG&#39;s Blog 保留一切权利 ｜ 粤ICP备15078531号-1<br></p>
      powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
      theme by <a href="https://github.com/Jiasm/hexo-theme-sheet" target="_blank">Sheet</a>
    </div>
    <ul class="contact-info">
      
        <a class="contact-link" href="https://github.com/zindexyg" target="_blank"><i class="fa fa-github"></i></a>
      
      
        <a class="contact-link" href="https://weibo.com/u/3249847654" target="_blank"><i class="fa fa-weibo"></i></a>
      
      
      
      
        <a class="contact-link" href="mailto:zinger_yg@163.com" target="_blank"><i class="fa fa-envelope"></i></a>
      
    </ul>
  </div>
</footer>



      <script>
      function footerHandler () {
        if (!window.screen || !document.body) return
        var hasComments = document.querySelector('.comments')
        if ((window.screen.availHeight - (hasComments ? 350 : 0)) > document.body.clientHeight) {
          document.body.classList.add('fixed')
        } else {
          document.body.classList.remove('fixed')
        }
      }
      footerHandler()
      window.addEventListener('resize', footerHandler)
    </script>
  </body>
  <script>
    var pathname = new URL(location.href).pathname.replace(/\/$/, '')

    switch (pathname) {
      case '/home':
        document.querySelector('.menu-item-contact').classList.add('active')
        break
      case '/about':
        document.querySelector('.menu-item-about').classList.add('active')
        break
      case '/links':
        document.querySelector('.menu-item-friends').classList.add('active')
        break
      default:
        document.querySelector('.menu-item-home').classList.add('active')
    }
  </script>
  

</html>
